<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; style-src 'self' 'unsafe-inline'; script-src 'self'"
    />
    <title>.mirrord</title>
    <link rel="stylesheet" href="styles/tailwind.out.css" />
    <link rel="stylesheet" href="styles/main.css" />
  </head>
  <body class="h-full bg-gray-100 font-sans text-gray-900 overflow-hidden text-sm">
    <div class="flex flex-col h-screen bg-gray-50">
      <!-- Title Bar -->
      <div class="flex items-center justify-between h-14 px-6 bg-white border-b border-gray-200 select-none z-10 relative" style="-webkit-app-region: drag">
        <div class="w-20"></div> <!-- Spacer for balance -->
        
        <!-- Center Title -->
        <div class="absolute inset-0 flex items-center justify-center pointer-events-none">
           <span class="text-blue-600 font-extrabold text-sm tracking-tighter uppercase">.mirrord</span>
        </div>

        <div class="flex gap-2 z-20" style="-webkit-app-region: no-drag">
          <button id="btn-settings" class="flex items-center justify-center w-9 h-9 rounded-lg text-gray-500 hover:bg-gray-100 hover:text-blue-600 transition-colors" title="Settings">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="12" cy="12" r="3"/>
              <path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z"/>
            </svg>
          </button>
        </div>
      </div>

      <!-- Main Content -->
      <main class="flex-1 flex flex-col max-w-4xl mx-auto w-full px-6 overflow-hidden">
        
        <!-- Top: Scrollable Devices Area -->
        <div class="flex-1 overflow-y-auto py-6 pr-1 custom-scrollbar">
            <!-- Devices Panel -->
            <div class="flex flex-col gap-4">
                <div class="flex justify-between items-center mb-2 sticky top-0 bg-gray-50 z-10 py-1">
                <h2 class="text-lg font-bold text-gray-900 m-0">Android Devices</h2>
                <div class="flex items-center gap-2">
                     <button id="btn-add-device" class="flex items-center justify-center w-9 h-9 bg-white border border-gray-200 rounded-lg text-gray-500 hover:border-blue-500 hover:text-blue-600 shadow-sm transition-transform hover:-translate-y-px" title="Connect Wireless Device">
                       <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                           <line x1="12" y1="5" x2="12" y2="19"></line>
                           <line x1="5" y1="12" x2="19" y2="12"></line>
                       </svg>
                     </button>
                     <button id="btn-restart-adb" class="flex items-center justify-center w-9 h-9 bg-white border border-gray-200 rounded-lg text-gray-500 hover:border-blue-500 hover:text-blue-600 shadow-sm transition-transform hover:-translate-y-px" title="Restart ADB">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                          <path d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                        </svg>
                     </button>
                </div>
            </div>

            <!-- Loading State -->
            <div id="loading-devices" class="flex flex-col items-center justify-center gap-4 py-12 text-center text-gray-500 transition-opacity duration-300">
               <div class="w-10 h-10 border-4 border-gray-200 border-t-blue-600 rounded-full animate-spin"></div>
               <p class="text-base font-medium">Searching for devices...</p>
            </div>

            <!-- Device List Container -->
            <div id="device-list" class="flex flex-col gap-4">
              <!-- Devices will be injected here -->
            </div>
            
            <!-- No devices state -->
            <div id="no-devices" class="hidden bg-white rounded-xl border-2 border-dashed border-gray-200 p-16 flex flex-col items-center justify-center gap-4 text-center">
              <svg class="text-gray-300 w-16 h-16 opacity-100 mb-2" xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" class="injected-svg" data-src="https://cdn.hugeicons.com/icons/smart-phone-01-duotone-rounded.svg?v=1.0.1" xmlns:xlink="http://www.w3.org/1999/xlink" role="img" color="#78909C">
<path opacity="0.4" d="M13.5 2H10.5C8.14298 2 6.96447 2 6.23223 2.73223C5.5 3.46447 5.5 4.64298 5.5 7V17C5.5 19.357 5.5 20.5355 6.23223 21.2678C6.96447 22 8.14298 22 10.5 22H13.5C15.857 22 17.0355 22 17.7678 21.2678C18.5 20.5355 18.5 19.357 18.5 17V7C18.5 4.64298 18.5 3.46447 17.7678 2.73223C17.0355 2 15.857 2 13.5 2Z" fill="#78909C"></path>
<path d="M12 19H12.01" stroke="#78909C" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
<path d="M13.5 2H10.5C8.14298 2 6.96447 2 6.23223 2.73223C5.5 3.46447 5.5 4.64298 5.5 7V17C5.5 19.357 5.5 20.5355 6.23223 21.2678C6.96447 22 8.14298 22 10.5 22H13.5C15.857 22 17.0355 22 17.7678 21.2678C18.5 20.5355 18.5 19.357 18.5 17V7C18.5 4.64298 18.5 3.46447 17.7678 2.73223C17.0355 2 15.857 2 13.5 2Z" stroke="#78909C" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
</svg>
              <p class="text-lg font-bold text-gray-900">No devices connected</p>
              <small class="text-gray-500 text-sm">Connect an Android device via USB with debugging enabled</small>
            </div>
        </div>
        </div>

        <!-- Bottom: Preferences (Sticky to bottom of sidebar) -->
        <div class="bg-white border border-gray-200 rounded-2xl p-6 shadow-sm flex flex-col gap-4">
          <h3 class="text-base font-semibold text-gray-900 mb-1">Preferences</h3>
          
          <div class="flex flex-col gap-4">
             <label class="flex items-center justify-between cursor-pointer">
               <span class="text-gray-700 font-medium">Auto-connect wireless</span>
               <div class="relative inline-flex items-center cursor-pointer">
                 <input type="checkbox" id="setting-auto-connect" class="sr-only peer">
                 <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
               </div>
             </label>

             <label class="flex items-center justify-between cursor-pointer">
              <span class="text-gray-700 font-medium">Show Device Serial</span>
              <div class="relative inline-flex items-center cursor-pointer">
                <input type="checkbox" id="setting-show-serial" class="sr-only peer">
                <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
              </div>
            </label>
          </div>
        </div>

      </main>

  
    <!-- Footer -->
    <div class="fixed bottom-0 left-0 w-full p-2 text-center text-xs text-white bg-blue-600">
      <span class="font-medium mr-1">.mirrord</span>
      <span id="app-version">v...</span>
    </div>

    <!-- Modals -->
    <footer class="py-4 bg-gray-50 border-gray-100">
        <p class="text-[10px] text-center text-gray-400 uppercase tracking-widest font-medium">.mirrord v1.0.0</p>
      </footer>
    </div>

    <script src="scripts/home/app.js"></script>

    <!-- Connect Modal -->
    <div id="modal-connect" class="fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm opacity-0 pointer-events-none transition-opacity duration-200" aria-hidden="true">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-sm p-6 transform translate-y-4 transition-transform duration-200 scale-95">
            <h3 class="text-lg font-bold text-gray-900 mb-4">Connect Wireless Device</h3>
            
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-1">Device IP Address</label>
                <input type="text" id="input-ip" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm" placeholder="192.168.1.x">
            </div>

            <div class="mb-6">
                <label class="block text-sm font-medium text-gray-700 mb-1">Port</label>
                <input type="number" id="input-port" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm" value="5555" placeholder="5555">
            </div>

            <div class="flex justify-end gap-3">
                <button id="btn-cancel-connect" class="px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-300">Cancel</button>
                <button id="btn-confirm-connect" class="px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">Connect</button>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal-overlay" id="modal-settings">
      <div class="modal-content max-w-md">
        <h3 class="text-lg font-bold mb-4">Settings</h3>
        
        <div class="space-y-4">
          <div>
            <label class="block text-xs font-semibold text-gray-400 uppercase tracking-wider mb-1.5 px-1">ADB Path</label>
            <div class="relative group">
              <input type="text" id="input-adb-path" class="w-full px-2.5 py-2 border border-blue-100 rounded-lg text-sm bg-gray-50 text-gray-800 outline-none focus:border-blue-500 transition-colors" placeholder="/path/to/adb (leave empty for automatic)">
            </div>
            <p class="mt-1.5 text-[10px] text-gray-500 px-1 italic">We'll look for ADB in common SDK locations if this is empty.</p>
          </div>

          <div id="adb-status-indicator" class="flex items-center gap-2 px-1 text-[11px] font-medium">
            <span class="w-2 h-2 rounded-full bg-gray-300" id="adb-status-dot"></span>
            <span id="adb-status-text" class="text-gray-500">Checking...</span>
          </div>
        </div>

        <div class="flex flex-col mt-6">
          <!-- Download Progress UI (Hidden by default) -->
          <div id="download-progress-container" class="hidden mb-4">
              <div class="flex justify-between text-sm mb-1">
                  <span id="download-status-text" class="text-gray-600 font-medium">Preparing...</span>
                  <span id="download-percentage" class="text-gray-500">0%</span>
              </div>
              <div class="w-full bg-gray-200 rounded-full h-2.5 overflow-hidden">
                  <div id="download-progress-bar" class="bg-blue-600 h-2.5 rounded-full transition-all duration-300" style="width: 0%"></div>
              </div>
          </div>

          <button id="btn-download-adb" class="hidden w-full px-4 py-3 text-base font-medium text-white bg-blue-600 rounded-xl hover:bg-blue-700 transition-all shadow-lg shadow-blue-200 flex items-center justify-center gap-2">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
              <polyline points="7 10 12 15 17 10"/>
              <line x1="12" y1="15" x2="12" y2="3"/>
            </svg>
            Download Platform Tools
          </button>
          
          <div class="flex gap-3 ml-auto mt-4" id="settings-actions">
            <button id="btn-close-settings" class="px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors">Cancel</button>
            <button id="btn-save-settings" class="px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors">Save Path</button>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
